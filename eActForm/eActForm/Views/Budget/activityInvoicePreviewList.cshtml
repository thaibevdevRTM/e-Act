
@model eActForm.Models.Budget_Approve_Model
@{
	Layout = null;
}

<script type="text/javascript">

	$('document').ready(function () {
		showCurrentDate();
	});

	function showCurrentDate() {
		n = new Date();
		y = n.getFullYear();
		m = n.getMonth() + 1;
		d = n.getDate();

		if (m < 10) { m = '0' + m }
		if (d < 10) { d = '0' + d }

		document.getElementById("docDate").innerHTML = d + "/" + m + "/" + y;
	}

    function onClickClose() {
        @*var url = '@Url.Action("activityProduct", "Budget")';
        window.location.href = url;*@
    }

	function onClickPrint() {
		genPdf();
	}
	
    function genPdf() {
            $.ajax({
            url: '@Url.Action("genPdfApprove", "Budget")',
            data: {
                GridHtml: $("#Grid").html(),
				activityId: $("#HactivityId").val()
            },
            dataType: "json",
            type: 'POST',
            }).done(function (response) {
                $("#WaitDialog").hide();
                console.log("genPdff");
                console.log('success');
                 });
	}


</script>

<style type="text/css">

	.my-bootbox-class .modal-dialog {
		width: 400px;
		font-size: 18px;
	}
</style>

@Html.HiddenFor(m => m.Budget_Activity_list.ElementAt(0).act_form_id, new { id = "HactivityId" })

<div class="modal-dialog modal-lg" style="width:95%;">
	<div class="modal-content">
		<div class="modal-header">
			<div style=""></div>
			<button type="button" class="close" data-dismiss="modal" onclick="onClickClose()">&times;</button>
		</div>

		<div class="modal-body">
			<div id="Grid" style="width:97%; margin-left:10px;">
				<style>
					.cssborderbottom {
						border-bottom-width: 1px;
						border-bottom-style: solid;
						border-bottom-color: gray;
					}
				</style>
				
				<div>
					<div style="text-align:center;"><h5>รายละเอียดค่าใช้จ่าย ตั้งจ่ายจริง</h5></div>
				</div>
				
				<div>
					<table style="border-bottom-width:1px; border-bottom-style: solid; border-bottom-color: gray; width:100%;"><tr><td>&nbsp;</td></tr></table>
				</div>
				
				<div>
					<table style="border-bottom-width:0px; border-bottom-style:solid; border-bottom-color:gray; width:100%;">
						<tr>
							<td style="width:50%;">&nbsp;</td>
							<td style="width:50%;">&nbsp;</td>
						</tr>


						<tr>
							<td style="text-align:left;"></td>
							<td style="text-align:right;">
								<label> Activity No : </label> @Model.Budget_Activity_list.ElementAt(0).act_activityNo
							</td>
						</tr>


						<tr>
							<td style="text-align:left">
								<label> ชื่อกิจกรรม (Activity Name) : </label> @Model.Budget_Activity_list.ElementAt(0).act_activityName
							</td>
							<td style="text-align:right;">
								<label> Document Date : </label> <span id="docDate"></span>
							</td>
						</tr>

						<tr>
							<td style="text-align:left;">
								<label> Theme : </label>  @Model.Budget_Approve_list.ElementAt(0).activityTypeTheme
							</td>
							<td style="text-align:right;">
								<label> ลูกค้า (Customer Name) : </label>  @Model.Budget_Activity_list.ElementAt(0).cus_cusNameTH
							</td>
						</tr>

						<tr>
							<td style="text-align:left;">
								<label> ระยะเวลากิจกรรม (Activity Period) : </label>
								@Model.Budget_Activity_list.ElementAt(0).act_activityPeriodSt.Value.ToString("dd/MM/yyyy")  to  @Model.Budget_Activity_list.ElementAt(0).act_activityPeriodEnd.Value.ToString("dd/MM/yyyy")
							</td>
							<td style="text-align:right;">
								<label> ช่องทาง (Channel) : </label> @Model.Budget_Activity_list.ElementAt(0).ch_chanelGroup
							</td>
						</tr>
						
						<tr>
							<td style="text-align:left;">
								<label> ระยะเวลาการให้ทุนพิเศษ (Cast Period) : </label>
								@Model.Budget_Activity_list.ElementAt(0).act_costPeriodSt.Value.ToString("dd/MM/yyyy")  to  @Model.Budget_Activity_list.ElementAt(0).act_costPeriodEnd.Value.ToString("dd/MM/yyyy")
							</td>
							<td style="text-align:right;">
								<label> กลุ่มสินค้า (Product Group) : </label> @Model.Budget_Activity_list.ElementAt(0).prd_groupShort
							</td>
						</tr>
						
						<tr>
							<td style="text-align:left;">
								<label> วัตถุประสงค์ (Objective) : </label>  @Model.Budget_Activity_list.ElementAt(0).act_objective
							</td>
							<td style="text-align:right;"></td>
						</tr>
						
						<tr>
							<td style="text-align:left;"></td>
							<td style="text-align:right;"></td>
						</tr>
						
						<tr>
							<td style="text-align:left;"></td>
							<td style="text-align:right;"></td>
						</tr>
						
						<tr>
							<td style="text-align:left;"></td>
							<td style="text-align:right;"></td>
						</tr>
					
					</table>
				</div>

				<div>
					<div>
						<table style="border-bottom-width:0px; border-bottom-style: solid; border-bottom-color: gray; width:100%;"><tr><td>&nbsp;</td></tr></table>
						<label> รายละเอียดการใช้จ่ายจริง (Actual) : </label>
					</div>

					
					<table class="tablethin" style="width:100%; text-align:center;" border="1" cellpadding="0" cellspacing="0">
						<tr>
							<td rowspan="2" style="width:10%; font-size:11px;">ประเภทกิจกรรม</td>
							<td rowspan="2" style="width:30%; font-size:11px;">กลุ่มสินค้า / ชื่อสินค้า</td>
							<td colspan="4" style="width:35%; font-size:11px;">จ่ายจริง (Actual)</td>

							<td rowspan="2" style="width:7%; font-size:11px;">ผลต่าง-บาท</td>
							<td rowspan="2" style="width:7%; font-size:11px;">วันที่ทำรายการ</td>
							<td rowspan="2" style="width:10%; font-size:11px;">สถานะ</td>
						</tr>
						<tr>
							<td style="font-size:11px;">จำนวนเงินที่ตั้ง</td>
							<td style="font-size:11px;">เลขที่ใบแจ้งหนี้</td>
							<td style="font-size:11px;">เลขที่ใบสำคัญจ่าย</td>
							<td style="font-size:11px;">จำนวนเงินจ่าย (฿)</td>
						</tr>

						@if (Model.Budget_Approve_list.Any())
						{
							var index = 0;
							foreach (var item in Model.Budget_Approve_list)
							{
								<tr>
									<td style="text-align:left;font-size:12px;">@item.activityTypeTheme</td>
									<td style="text-align:left;font-size:12px;">@item.productDetail</td>
									<td style="text-align:right;font-size:12px;"> @string.Format("{0:n2}", item.productStandBath)</td>
									<td style="text-align:center;font-size:12px;">@item.invoiceNo</td>
									<td></td>
									<td style="text-align:right;font-size:12px;">@string.Format("{0:n2}", item.invoiceTotalBath)</td>
									<td style="text-align:right;font-size:12px;">@string.Format("{0:n2}", item.productBalanceBath)</td>
									<td style="text-align:center;font-size:12px;">@item.invoiceActionDate.Value.ToString("dd/MM/yyyy")</td>
									<td style="text-align:center;font-size:12px;">@item.invoiceBudgetStatusNameTH</td>
								</tr>
								index++;
							}
						}
					</table>
				</div>

			</div>
		</div>

		<div class="modal-footer">
			<div>
				<p class="d-flex justify-content-center">
					<button type="button" class="btn btn-success pull-right" data-dismiss="modal" onclick="onClickPrint();"><i class="fa fa fa-print fa-fw"></i>&nbsp;Print</button>
					<button type="button" class="btn btn-primary pull-right" data-dismiss="modal" onclick="onClickClose();"><i class="fa fa fa-reply fa-fw"></i>&nbsp;Close</button>
				</p>
			</div>

		</div>

	</div>
</div>