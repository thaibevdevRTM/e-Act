@model eActForm.Models.TB_Bud_Image_Model.BudImageModel
@{
	/**/

	//Layout = null;
	//Layout = "~/Views/Shared/_BlankLayout.cshtml";
	ViewBag.Title = "";
	//var url = System.Configuration.ConfigurationManager.AppSettings["urlUploadfilesBudget"].ToString();
}

<style type="text/css">

	.font8 {
		font-size: 8px;
	}

	.font10 {
		font-size: 10px;
	}

	.textRight {
		text-align: right;
	}

	.textLeft {
		text-align: left;
	}

	.inner {
		display: inline-block;
	}

	.wide-nolimit {
		max-width: 100%;
	}

	#outer {
		width: 100%;
		text-align: center;
	}
</style>

@if (Model.id != null)
{

	//------------------------------------------------------------------------------------------------
	@Html.HiddenFor(item => @Model.id, new { @id = "hd_imageId" })

	<div>
		<table class="tablethin" style="width:100%;" border="0" cellpadding="0" cellspacing="0">
			<tr>
				<td width="5%"> &nbsp; &nbsp;</td>
				<td style="width:20%;text-align:left;"> <h5>ชื่อไฟล์ : </h5></td>

				<td style="width:100%;text-align:left;">
					@Html.DisplayFor(item => @Model._fileName, new { @id = "txt_fileName" })
					@Html.HiddenFor(item => @Model.company, new { @id = "hd_company" })
				</td>
			</tr>

			@if (@Model.company == "OMT")
			{
				<tr>
					<td> </td>
					<td align="left"> <h5>Region : </h5></td>

					<td>
						@Html.TextBoxFor(item => item.regionName, new { @class = "form-control wide-nolimit", @id = "txt_region", @name = "txt_region" })
						@Html.HiddenFor(item => item.regionId, new { id = "txt_region_id" })
					</td>
				</tr>
			}

			<tr>
				<td> </td>
				<td align="left"> <h5>ลูกค้า : </h5></td>

				<td>
					@Html.TextBoxFor(item => item.customerName, new { @class = "form-control wide-nolimit", @id = "txt_customer", @name = "txt_customer" })
					@Html.HiddenFor(item => item.customerId, new { id = "txt_customer_id" })
				</td>


			</tr>

			<tr>
				<td></td>
				<td> <h5>เลขที่ใบแจ้งหนี้ : </h5></td>
				<td>
					@Html.TextBoxFor(item => item.invoiceNo, new { @class = "form-control textboxcss wide-nolimit", @id = "txt_invoice_no" })
				</td>
			</tr>

			<tr>
				<td> </td>
				<td> <h5>หมายเหตุ : </h5></td>

				<td>
					@Html.TextBoxFor(item => item.remark, new { @class = "form-control textboxcss wide-nolimit", @id = "txt_remark" })
				</td>
			</tr>
		</table>
	</div>

	<div>
		<p class="d-flex justify-content-center">
			<button type="button" class="btn btn-sm ink-reaction pull-right btn-success" onclick="submitManageInvoiceUpdate();"><i class="fa fa fa-check fa-fw"></i>&nbsp;Save</button>
			<button type="button" class="btn btn-sm ink-reaction pull-right btn-default" onclick="refreshInvoice();"><i class="fa fa fa-refresh fa-fw"></i>&nbsp;Refresh</button>

		</p>
	</div>


	//------------------------------------------------------------------------------------------------

	<div> <table style="border-bottom-width:1px; border-bottom-style: solid; border-bottom-color: gray; width:100%;"><tr><td>&nbsp;</td></tr></table> </div>

	@Html.Action("invoicePDFView", "BudgetViewer", new { fileName = Model._fileName })

}

<script type="text/javascript">
		$(document).ready(function () {
		ObjModel = {};

			$("#txt_customer").autocomplete({
                   source: function (request, response) {
                    $.ajax({
                        url: '@Url.Action("getCustomerInvoice", "Budget")',
                        type: "POST",
                        dataType: "json",
                        data: {
							customerTH: $("#txt_customer").val(),
							companyEN: $("#hd_company").val(),
							regionId: $("#txt_region_id").val(),
                        },
						success: function (data) {
							response($.map(data, function (item) {
								return { label: item.cusNameTH, value: item.cusNameTH, id: item.id };
                                   }))

                        }
                           })
                },
                minLength: 0,
                messages: {
                       noResults: '',
                    results: function (resultsCount) {
                           }
                       }, select: function (event, ui) {
					$("#txt_customer_id").val(ui.item.id)
                           }
            }).focus(function () {
                $(this).data("uiAutocomplete").search($(this).val());
				});

			//-----------------------------------------------------------------------------------

			$("#txt_region").autocomplete({
                   source: function (request, response) {
                    $.ajax({
                        url: '@Url.Action("getRegionInvoice", "Budget")',
                        type: "POST",
                        dataType: "json",
                        data: {
							nameEN: $("#txt_region").val(),
                        },
						success: function (data) {
							response($.map(data, function (item) {
								return { label: item.name, value: item.name, id: item.id };
                                   }))

                        }
                           })
                },
                minLength: 0,
                messages: {
                       noResults: '',
                    results: function (resultsCount) {
                           }
                       }, select: function (event, ui) {
					$("#txt_region_id").val(ui.item.id)
                           }
            }).focus(function () {
                $(this).data("uiAutocomplete").search($(this).val());
				});
	});

	function refreshInvoice() {
		callManageInvoiceList();
		$("#divManageInvoiceView").html("");
	}

</script>