
@model eActForm.Models.Budget_Activity_Model
@{
	ViewBag.Title = "Edit Page";
}

<link href="~/Content/jquery.datetimepicker.css" rel="stylesheet" />
<script src="~/Scripts/jquery.datetimepicker.full.js"></script>
<script src="~/Scripts/jquery-migrate-1.2.1.min.js"></script>
<script src="~/Scripts/dropzone/dropzone.min.js"></script>
<link href="~/Scripts/dropzone/dropzone.min.css" rel="stylesheet" />

<style type="text/css">

	.my-bootbox-class .modal-dialog {
		width: 400px;
		font-size: 18px;
	}
</style>



<div class="alert alert-success" role="alert">
	<h4 class="alert-heading">
		แบบฟอร์มรายละเอียดค่าใช้จ่ายตั้งจ่ายจริง  กิจกรรมเลขที่ :
		@if (Model.Budget_Activity_Product_list.Count > 0)
		{
			@Html.DisplayFor(item => Model.Budget_Activity_Product_list.ElementAt(0).act_activityNo)
		}
	</h4>
	<p></p>
</div>


<table class="table table-striped table-hover" id="datatable">
	<thead class="thead-dark">
		<tr class="gradeX" style="background-color:#2B5D95;color:#ffffff;">
			<th class="align-content-center font12B"></th>
			<th class="align-content-center font12B" style="width:15%;">ประเภทกิจกรรม</th>
			<th class="align-content-center font12B" style="width:25%;">กลุ่มสินค้า/ชื่อสินค้า</th>
			<th class="font12B" style="text-align:right;">จำนวนเงินที่ตั้ง</th>
			@*<th class="align-content-center font12B">เลขที่ใบแจ้งหนี้</th>*@
			@*<th class="align-content-center font12B">เลขที่ใบสำคัญจ่าย</th>
				<th class="align-content-center font12B">ยอดขายช่วงทำกิจกรรม case</th>
				<th class="align-content-center font12B">ยอดขายช่วงทำกิจกรรม bath</th>*@
			<th class="font12B" style="text-align:right;">จำนวนเงินจ่าย(รวม)</th>
			<th class="font12B" style="text-align:right;">ผลต่าง-บาท</th>
			@*<th class="align-content-center font12B" >วันที่ทำรายการ</th>*@
			<th class="align-content-center font12B" style="width:10%;">สถานะ</th>
		</tr>
	</thead>

	<tbody>
		@if (Model.Budget_Activity_Product_list.Count > 0)
		{
			var index = 0;
			foreach (var item in Model.Budget_Activity_Product_list)
			{
				<tr class="gradeX">
					<td>
						<a href="javascript:" class="btn ink-reaction btn-success fa fa-search" onclick="javascript:callInvoiceList('@item.act_activityId','@item.activityOfEstimateId');"></a>
					</td>

					<td style="font-size:12.5px;">@item.act_typeTheme</td>
					<td style="font-size:12.5px;">@item.prd_productDetail</td>
					<td style="font-size:12.5px;text-align:right;">
						@if (item.totalCost != 0)
						{
							string result = String.Format("{0:n2}", @item.totalCost);
							@result.ToString();
						}
					</td>
					@*------  display when have invoice row ---------*@
					<td style="font-size:12.5px;text-align:right;">
						@*จำนวนเงินจ่าย*@
						@if (item.totalCost != 0)
						{
							string result = String.Format("{0:n2}", @item.invTotalBath);
							@result.ToString();
						}
					</td>

					<td style="font-size:12.5px;text-align:right;">
						@*ผลต่าง-บาท*@
						@if (item.totalCost != 0)
						{
							string result = String.Format("{0:n2}", @item.productBalanceBath);
							@result.ToString();
						}
					</td>
					@*--------------------------------------------------*@
					<td style="font-size:12.5px;">@item.budgetStatusNameTH</td>
				</tr>
				index++;
			}
		}
	</tbody>
</table>
<br />
<hr />

<div id="divPreview">
</div>

<br />
<hr />

<script>
	function callInvoiceList(activityId, activityOfEstimateId) {
        $.ajax({
            type: 'POST',
            url:  '@Url.Action("activityProductInvoiceList", "Budget")',
            data: {
				activityId: activityId,
				activityOfEstimateId: activityOfEstimateId
            }
        }).done(function (htmlResponse) {
			$("#divPreview").html(htmlResponse);
        });
		}


    @*function onDelete(actId,prdId,estId,invNo) {
        var msg = "";

            // can be delete
		msg = "คุณต้องการลบเอกสาร " + invNo +" นี้หรือไม่?"

        bootbox.confirm({
            title: "Confirm Message",
            message: msg,
            buttons: {
                confirm: {
                    label: "Yes",
                    className: "btn-success"
                },
                cancel: {
                    label: "No",
                    className: "btn-danger"
                }
            },
            callback: function (result) {
                if (result) {
                    $.ajax({
                        url: '@Url.Action("delInvoiceDetail", "Budget")',
                        data: {
                            actId: actId,
							prdId: prdId,
							estId: estId,
							invNo: invNo,
						},
						success: function (response) {
							console.log(response.success);
							window.location.reload()
						}

					})
                }
            }
        });
    }*@

	//function onSelectProduct(actId, prdId,estId) {
	//		var TeamDetailPostBackURL = '/Budget/PreviewBudgetInvoice';
	//		debugger;
	//		//var $buttonClicked = $(this);
	//		var var_activityId = actId;
	//		var var_productId = prdId;
	//		var var_estId = estId;
	//		var options = { "backdrop": "static", keyboard: true };

	//		$.ajax({
	//			type: "GET",
	//			url: TeamDetailPostBackURL,
	//			contentType: "application/json; charset=utf-8",
	//			data: {
	//				"activityId": var_activityId,
	//				"productId": var_productId,
	//				"activityOfEstimateId": var_estId
	//			},
	//			datatype: "json",
	//			success: function (data) {
	//				debugger;
	//				$('#myModalContent').html(data);
	//				$('#myModal').modal(options);
	//				$('#myModal').modal('show');
	//			},
	//			error: function () {
	//				alert("Dynamic content load failed.");
	//			}
	//		});
	//}

	@*function callInvoiceList(actId) {
		var var_activityId = actId;
		alert(var_activityId);
        $.ajax({
            type: 'POST',
            url:  '@Url.Action("activityInvoiceList", "Budget")',
			data:
			{
				"activityId": var_activityId
			}
        }).done(function (htmlResponse) {
			$("#div_activityProductInvoiceList").html(htmlResponse)
        });
    }*@


</script>