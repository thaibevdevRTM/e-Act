@using eActForm.BusinessLayer;
@model eActForm.Models.Activity_TBMMKT_Model


@if (Model.budgetTotalList.Any())
{
    <div id="divProgress" class="row">
        <style>
            .cssborderbottom {
                border-bottom-width: 1px;
                border-bottom-style: solid;
                border-bottom-color: gray;
            }
        </style>
        <br />
        <table class="tablethin" align="right">

            @{ int row = 0; }

            @foreach (var mainItem in Model.budgetMainTotalList)
            {
                if (!string.IsNullOrEmpty(mainItem.brandId))
                {

                    <tr>
                        <td style="background-color:#2f74b5;color:white; border-style: solid; border-width: 1px 0px 1px 1px; border-collapse: collapse;" class="cssborderbottom"> </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;ปีงบ @mainItem.yearBG &nbsp;งบประมาณ @mainItem.brandName </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">@mainItem.totalBudget.Value.ToString("#,##0.00")</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">@mainItem.useAmountTotal.Value.ToString("#,##0.00")</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">@mainItem.returnAmount.Value.ToString("#,##0.00")</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp; </td>
                        <td style="border-style: solid; border-width: 1px 1px 1px 0px; border-collapse: collapse;">@mainItem.amountBalanceTotal.Value.ToString("#,##0.00")</td>
                    </tr>
                }
                else
                {
                    <tr style="background-color:#2f74b5;color:white;">
                        <td style="border-style: solid; border-width: 1px 0px 1px 1px; border-collapse: collapse;">
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            &nbsp;ปีงบ @mainItem.yearBG &nbsp; งบประมาณช่องทาง @mainItem.channelName
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            @mainItem.totalBudget.Value.ToString("#,##0.00")
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            &nbsp;ใช้ไปสะสม&nbsp;&nbsp;
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            @mainItem.useAmountTotal.Value.ToString("#,##0.00")
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            return&nbsp;&nbsp;
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            @mainItem.returnAmount.Value.ToString("#,##0.00")
                        </td>
                        <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                            &nbsp;คงเหลือ&nbsp;&nbsp;
                        </td>
                        <td style="border-style: solid; border-width: 1px 1px 1px 0px; border-collapse: collapse;">
                            @mainItem.amountBalanceTotal.Value.ToString("#,##0.00")
                        </td>
                    </tr>
                }

                foreach (var item in Model.budgetTotalList)
                {
                    if (item.yearBG == mainItem.yearBG)
                    {
                        string result = String.Format("{0:n2}", item.amountBalancePercen);
                        int intBalance = Convert.ToInt32(item.amountBalancePercen);

                        if (Model.budgetTotalList.Count != row + 1)
                        {

                            if (!string.IsNullOrEmpty(item.brandId))
                            {
                                <tr style="background-color: #808080; color: white;">
                                    <td style="border-style: solid; border-width: 0px 0px 1px 1px; border-collapse: collapse; text-align:right;"> </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse; text-align: right;">&nbsp;ปีงบ @item.yearBG &nbsp;งบ @item.activityType </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.amount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.useAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.returnAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 1px 1px 0px; border-collapse: collapse;">@item.amountBalance.Value.ToString("#,##0.00")</td>

                                </tr>
                            }
                            else
                            {
                                <tr style="background-color: #808080; color: white;">
                                    <td style="border-style: solid; border-width: 0px 0px 1px 1px; border-collapse: collapse; text-align: right;"> </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse; text-align: right;">&nbsp;ปีงบ @item.yearBG &nbsp;งบ @item.brandName </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.amount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.useAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.returnAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 1px 1px 0px; border-collapse: collapse;">@item.amountBalance.Value.ToString("#,##0.00")</td>
                                </tr>
                            }
                        }
                        else
                        {
                            if (!string.IsNullOrEmpty(item.brandId))
                            {
                                <tr style="background-color: #808080; color: white;">
                                    <td style="border-style: solid; border-width: 0px 0px 1px 1px; border-collapse: collapse; text-align: right;"> </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse; text-align: right;">&nbsp;ปีงบ @item.yearBG &nbsp;งบ @item.activityType </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.amount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.useAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.returnAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 1px 1px 0px; border-collapse: collapse;">@item.amountBalance.Value.ToString("#,##0.00")</td>

                                </tr>
                            }
                            else
                            {
                                <tr style="background-color: #808080; color: white;">
                                    <td style="border-style: solid; border-width: 0px 0px 1px 1px; border-collapse: collapse; text-align: right;"> </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse; text-align: right;">&nbsp;ปีงบ @item.yearBG &nbsp; งบ @item.brandName </td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.amount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.useAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@item.returnAmount.Value.ToString("#,##0.00")</td>
                                    <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 0px 1px 1px 0px; border-collapse: collapse;">@item.amountBalance.Value.ToString("#,##0.00")</td>
                                </tr>
                            }
                        }



                        foreach (var itemActMain in Model.budgetMainActTypelList)
                        {
                            if (itemActMain.yearBG == item.yearBG)
                            {

                                <tr>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 1px; border-collapse: collapse;">
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        งบประมาณกิจกรรม @itemActMain.activityType.Substring(0, 2)
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        @itemActMain.totalBudget.Value.ToString("#,##0.00")
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        &nbsp;ใช้ไปสะสม&nbsp;&nbsp;
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        @itemActMain.useAmountTotal.Value.ToString("#,##0.00")
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        return&nbsp;&nbsp;
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        @itemActMain.returnAmount.Value.ToString("#,##0.00")
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 0px 1px 0px; border-collapse: collapse;">
                                        &nbsp;คงเหลือ&nbsp;&nbsp;
                                    </td>
                                    <td style="border-style: solid; border-width: 1px 1px 1px 0px; border-collapse: collapse;">
                                        @itemActMain.amountBalanceTotal.Value.ToString("#,##0.00")
                                    </td>
                                </tr>

                                foreach (var itemAct in Model.budgetTotalActTypeList)
                                {
                                    if (itemAct.yearBG == itemActMain.yearBG && itemActMain.activityType == itemAct.activityType && item.brandName == itemAct.brandName)
                                    {

                                        <tr>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 1px; border-collapse: collapse; text-align: right;"> </td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse; text-align: right;">&nbsp;งบ @itemAct.brandName </td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ทั้งปี&nbsp;&nbsp;</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@itemAct.totalBudget.Value.ToString("#,##0.00")</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;ใช้ไปสะสม&nbsp;&nbsp;</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@itemAct.useAmountTotal.Value.ToString("#,##0.00")</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;return&nbsp;&nbsp;</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">@itemAct.returnAmount.Value.ToString("#,##0.00")</td>
                                            <td style="border-style: solid; border-width: 0px 0px 1px 0px; border-collapse: collapse;">&nbsp;คงเหลือ&nbsp;&nbsp;</td>
                                            <td style="border-style: solid; border-width: 0px 1px 1px 0px; border-collapse: collapse;">@itemAct.amountBalanceTotal.Value.ToString("#,##0.00")</td>

                                        </tr>

                                    }

                                }

                            }
                        }

                        row++;
                    }


                }

            }


        </table>
    </div>
}



