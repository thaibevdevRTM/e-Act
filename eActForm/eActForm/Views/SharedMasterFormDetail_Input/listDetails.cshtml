@using eActForm.BusinessLayer;
@model eActForm.Models.Activity_TBMMKT_Model
<tr style="border-bottom:none;">
    <td>
        <div id="divHeaderDetailsCost" runat="server" style="width: 100%;padding-left:15px;padding-right:15px;">
            <table class="table table-bordered" id="tabelHeaderDetails" runat="server">
                <tr style="background-color:#2f74b5;color:white;height:25px;">
                    <th style="width: 10%;border-style: solid;border-width: 0px 1px 0px 1px; border-collapse: collapse;text-align:center;">ที่</th>
                    <th style="width: 50%;border-style: solid;border-width: 0px 1px 0px 0px; border-collapse: collapse;text-align:center;">รายการ</th>
                    <th style="width: 15%;border-style: solid;border-width: 0px 1px 0px 0px; border-collapse: collapse;text-align:center;">จำนวนเงิน(บาท)</th>
                    <th style="width: 30%;border-style: solid;border-width: 0px 1px 0px 0px; border-collapse: collapse;text-align:center;">หมายเหตุ</th>
                </tr>
                @{ var index = 0;}
                @foreach (var item in Model.activityOfEstimateList)
                {
                    <tr class="tagCountRowinTable">
                        <td style="border-style: solid;border-width: 1px 1px 0px 1px; border-collapse: collapse;text-align:center;">
                            <input type="text" value="@(index+1)" id="activityOfEstimateList[@index].rowNo" name="activityOfEstimateList[@index].rowNo" class="form-control textboxcss clstxtIO" readonly="readonly" style="text-align:center;" />
                        </td>
                        <td style="border-style: solid;border-width: 1px 1px 0px 0px; border-collapse: collapse;text-align:center;">
                            <input type="text" value="@item.productDetail" id="activityOfEstimateList[@index].productDetail" name="activityOfEstimateList[@index].productDetail" class="form-control textboxcss" />
                        </td>
                        <td style="border-style: solid;border-width: 1px 1px 0px 0px; border-collapse: collapse;text-align:right;">
                            <input type="hidden" value="@item.total" id="activityOfEstimateList[@index].total" name="activityOfEstimateList[@index].total" class="form-control textboxcss text-right hidtotal_@index" />
                            @Html.TextBoxFor(x => item.total, "{0:n2}", new { @id = "activityOfEstimateList[" + index + "].total", Name = "activityOfEstimateList[" + index + "].total", @class = "form-control textboxcss text-right txttotal_" + index })
                            <script>
                                $(".txttotal_@index").blur(function () {
                                    sumall();
                                });
                            </script>
                        </td>
                        <td style="border-style: solid;border-width: 1px 1px 0px 0px; border-collapse: collapse;text-align:center;">
                            <input type="text" value="@item.remark" id="activityOfEstimateList[@index].remark" name="activityOfEstimateList[@index].remark" class="form-control textboxcss" />
                        </td>
                    </tr>
                    index++;
                }
                <tr>
                    <td colspan="2" style="border-style: solid;border-width: 1px 1px 0px 0px; border-collapse: collapse;text-align:right;">
                        จำนวนเงินรวม(บาท)&nbsp;
                    </td>
                    <td style="border-style: solid;border-width: 1px 1px 1px 0px; border-collapse: collapse;text-align:right;">
                        <label id="totalEstimate" type="text" readonly="readonly">@Model.totalCostThisActivity.Value.ToString("#,###.00")</label>&nbsp;
                    </td>
                    <td style="border-style: solid;border-width: 1px 1px 0px 0px; border-collapse: collapse;text-align:right;">
                        &nbsp;
                    </td>
                </tr>
            </table>
            <script>
                function sumall() {
                    var totalAll = 0.00;
                    var rowCount = parseInt($('#tabelHeaderDetails tr.tagCountRowinTable').length);

                    for (i = 0; i < rowCount; i++) {
                        var rowtotal = parseFloat($(".txttotal_" + i.toString()).val().replace(",", ""));
                        $(".hidtotal_" + i.toString()).val(rowtotal.toFixed(2));
                        totalAll = totalAll + rowtotal;
                    }

                    $("#totalEstimate").text(totalAll.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
                }
            </script>
        </div>
    </td>
</tr>