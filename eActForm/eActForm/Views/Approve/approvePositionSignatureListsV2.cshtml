@model eActForm.Models.ApproveModel.approveModels
@using eActForm.Models;
@using System.Configuration;
<style>
    .line1px {
        border-bottom: groove;
        border-width: 1px;
        border-color: gray;
    }

    .borderbottom {
        border-bottom: dashed;
        border-width: 1px;
        border-color: gray;
    }
</style>
@if (Model.activity_TBMMKT_Model == null)
{
    Activity_TBMMKT_Model activity_TBMMKT_Model = new Activity_TBMMKT_Model();
    Model.activity_TBMMKT_Model = activity_TBMMKT_Model;
    ActivityFormTBMMKT activityFormTBMMKT = new ActivityFormTBMMKT();
    activityFormTBMMKT.master_type_form_id = "";
    Model.activity_TBMMKT_Model.activityFormTBMMKT = activityFormTBMMKT;
}

@if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
{
    ApproveFlowModel.flowApproveDetail flowApproveDetail = new ApproveFlowModel.flowApproveDetail();
    flowApproveDetail.approveGroupName = "ผู้รับของ";
    flowApproveDetail.approveGroupNameEN = "Received By";
    flowApproveDetail.empFNameTH = "                                    ";
    flowApproveDetail.empLNameTH = "";
    flowApproveDetail.empPositionTitleTH = "";
    flowApproveDetail.isShowInDoc = true;
    Model.approveFlowDetail.Add(flowApproveDetail);
}

<div class="text-center">
    @if (TempData["approvePositionSignatureError"] != null)
    {
        <div><p class="warning"><h3>@TempData["approvePositionSignatureError"]</h3> </p></div>
    }
    else
    {
        if (Model.approveFlowDetail == null)
        {
            <div><p class="warning"><h4>ตรวจสอบไม่พบ flow อนุมัติ <br /> กรุณาติดต่อ ส่วนงานพัฒนาระบบงานสนับสนุน<br /> เบอร์โทรศัพท์ติดต่อ : 02-785-5555 ext. 5744,4607,4580</h4> </p></div>
        }
        else
        {

            @Grid1();
            var haveShowNameGreatherThanFive = 0;
            foreach (var item in Model.approveFlowDetail)
            {
                if (item.isShowInDoc)
                {
                    haveShowNameGreatherThanFive += 1;
                }
            }
            if (haveShowNameGreatherThanFive > 6)
            {
                @Grid2();
            }

        }
    }
</div>


@helper Grid1()
    {

        <table class="tablethin" style="text-align:center;" border="1" cellpadding="0" cellspacing="0">
            <tr>
                @{ int countisShowInDoc = 0;
                    string yu = "คุณ";}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc <= 6)
                        {
                            <td style="width:120px;">
                                @{ if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div class="fontSigV1">
                                            @item.approveGroupName
                                        </div>
                                        <div class="fontSigV1">
                                            (@item.approveGroupNameEN)
                                        </div>
                                    }
                                    else
                                    {
                                        <div style="font-size:12.5px;">
                                            @item.approveGroupName
                                        </div>
                                        <div style="font-size:12.5px;">
                                            (@item.approveGroupNameEN)
                                        </div>
                                    }
                                }
                            </td>
                        }
                    }
                }
            </tr>

            <tr>
                @{ int index = 0;
                    countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc <= 6)
                        {
                            int writeoneHit = 0;
                            foreach (var itemFlowByDoc in Model.approveDetailLists)
                            {
                                if (writeoneHit == 0)
                                {
                                    if (itemFlowByDoc.empId == item.empId && itemFlowByDoc.statusId == "3" && itemFlowByDoc.rangNo == item.rangNo)
                                    {
                                        <td height="85">
                                            <img style="text-align:center;" width="115" height="80" src="@itemFlowByDoc.ImgName" />
                                        </td>
                                        writeoneHit += 1;
                                    }
                                }
                            }
                            if (writeoneHit == 0)
                            {
                                <td>
                                    <div style="text-align:center;height:80px;"></div>
                                </td>
                            }
                        }
                    }

                    index++;
                }
            </tr>

            <tr>
                @{ countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc <= 6)
                        {
                            <td>
                                @{if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div style="text-align:center; margin-top:5px;" class="fontSigV1">@yu@item.empFNameTH @item.empLNameTH</div>
                                    }
                                    else
                                    {
                                        <div style="text-align:center; margin-top:5px; font-size:12.5px;">@yu@item.empFNameTH @item.empLNameTH</div>
                                    }
                                }
                            </td>
                        }

                    }

                }
            </tr>
            <tr>
                @{ countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc <= 6)
                        {
                            <td>
                                @{if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div style="text-align:center;height:50px;" class="fontSigV1">@Html.Raw(item.empPositionTitleTH)</div>
                                    }
                                    else
                                    {
                                        <div style="text-align:center; height:50px; font-size:12.5px;">@Html.Raw(item.empPositionTitleTH)</div>
                                    }
                                }
                            </td>
                        }

                    }
                }
            </tr>
        </table>
}


@helper Grid2()
    {
        <table class="tablethin" style="text-align:center;" border="1" cellpadding="0" cellspacing="0">
            <tr>
                @{ int countisShowInDoc = 0;
                    string yu = "คุณ";}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc >= 6)
                        {
                            <td style="width:120px;">
                                @{ if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div class="fontSigV1">
                                            @item.approveGroupName
                                        </div>
                                        <div class="fontSigV1">
                                            (@item.approveGroupNameEN)
                                        </div>
                                    }
                                    else
                                    {
                                        <div style="font-size:12.5px;">
                                            @item.approveGroupName
                                        </div>
                                        <div style="font-size:12.5px;">
                                            (@item.approveGroupNameEN)
                                        </div>
                                    }
                                }
                            </td>
                        }
                    }
                }
            </tr>

            <tr>
                @{ int index = 0;
                    countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc >= 6)
                        {
                            int writeoneHit = 0;
                            foreach (var itemFlowByDoc in Model.approveDetailLists)
                            {
                                if (writeoneHit == 0)
                                {
                                    if (itemFlowByDoc.empId == item.empId && itemFlowByDoc.statusId == "3" && itemFlowByDoc.rangNo == item.rangNo)
                                    {
                                        <td height="85">
                                            <img style="text-align:center;" width="115" height="80" src="@itemFlowByDoc.ImgName" />
                                        </td>
                                        writeoneHit += 1;
                                    }
                                }
                            }
                            if (writeoneHit == 0)
                            {
                                <td>
                                    <div style="text-align:center;height:80px;"></div>
                                </td>
                            }
                        }
                    }

                    index++;
                }
            </tr>

            <tr>
                @{ countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc >= 6)
                        {
                            <td>
                                @{if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div style="text-align:center; margin-top:5px;" class="fontSigV1">@yu@item.empFNameTH @item.empLNameTH</div>
                                    }
                                    else
                                    {
                                        <div style="text-align:center; margin-top:5px; font-size:12.5px;">@yu@item.empFNameTH @item.empLNameTH</div>
                                    }
                                }
                            </td>
                        }

                    }

                }
            </tr>
            <tr>
                @{ countisShowInDoc = 0;}
                @foreach (var item in Model.approveFlowDetail)
                {
                    if (item.isShowInDoc)
                    {
                        countisShowInDoc++;
                        if (countisShowInDoc >= 6)
                        {
                            <td>
                                @{if (Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formAdvTbmId"] || Model.activity_TBMMKT_Model.activityFormTBMMKT.master_type_form_id == ConfigurationManager.AppSettings["formPosTbmId"])
                                    {
                                        <div style="text-align:center;height:50px;" class="fontSigV1">@Html.Raw(item.empPositionTitleTH)</div>
                                    }
                                    else
                                    {
                                        <div style="text-align:center; height:50px; font-size:12.5px;">@Html.Raw(item.empPositionTitleTH)</div>
                                    }
                                }
                            </td>
                        }

                    }
                }
            </tr>
        </table>
}